<html>
	<head>
		<title>jsonp test</title>
		<script src="http://code.jquery.com/jquery-1.6.2.min.js"></script>		
		<script type="text/javascript">
            $(function(){				
                $('#select_link').click(function(e){
                    //e.preventDefault();
					
					$.ajax({
						type: 'GET',
						data: '',
				        contentType: 'application/json',
                        url: 'http://localhost:3000/api',						
                        success: function(data) {
							publishUser(data);
                        }
                    });
					var type = 'GET',
						requestData = 'hi',
						contentType = 'application/json',
						url = 'http://localhost:3000/api',
						callback = publishUser;
						
					//server_transport(type, contentType, url, callback);
                });
				
				function publishUser(data) {
					
					var userList = document.getElementById('users-list');
					var newDiv = '';
					
					for(var id in data){
						newDiv += '<div id="id_' + id + '">' + '<div id="mail_' + id + '">' + '<p>' + data[id].mail + '</p>' + '</div>' + '<div id="pass_' + id + '">' + 
						'<p>' + data[id].pass + '</p>' + '</div>' + '</div>';
					}
					
					userList.innerHTML = newDiv;
				};
				
				function server_transport(type, requestData, contentType, url, callback) {
				//console.log(type, requestData, contentType, url, callback);
					$.ajax({
						type: type,
						data: requestData,
				        contentType: contentType,
                        url: url,						
                        success: function(data) {
							callback(data);
                        }
                    });
				}
            });
        </script>
    </head>
    <body>
        <div id="select_div"><a href="#" id="select_link">Test</a></div>
			<div id="users-list"></div>
    </body>
</html>